<% provide(:full_title, "チャット詳細") %>
<%#div class="row"%>

  <header class="header text-center">
<% if user_signed_in? %>
  <h3><%= @chat_room.company.name %>とのチャットルーム</h3>
  <div class="chatPartner">
    <%= @chat_room.user.name %>
     <% end %>
    </div>
  </header>

<%#div class="chatPage"%>
  <div class="container">
 <div class="row">
  <%#div class="messagesArea messages"%>

 <div class="col-lg-12">
  <% if @chat_messages.present? %>
   <% @chat_messages.each do |m| %>
      <% if m.is_user = true %>


         <h4 class="text-right">
          <p class="alert alert-success">
 <%= m.message %>
          <br>
          <small><strong><a href="/users/<%= @chat_room.user_id %>"><%=  @chat_room.user.name %></a></strong></small><br>
         <%= image_tag @chat_room.user.profile_photo.url(:thumb),class:"round-img" %>
          </p>
          </h4>
      <% else  m.is_user = false %>
          <%#= m.message %>
      <% end %>
        <% end %>
  <% elsif @chat_messages.nil? %>
      <br>
      <h3 class="text-center">メッセージはまだありません</h3>
      <br>

  <% end %>
</div>

    </div>


</div>

<form class="messageInputForm">
<hr>
  <%#= form_with(model:@chat_message ,url:chat_room_path,local:true,method: :post)do |f| %>
    <%#= form_with(model:@chat_message,url:chat_room_chat_messages_path,local:true,method: :post) do |f| %>
<%= form_with scope: :chat_message, url:chat_room_chat_messages_path do |f| %>
<%#= form_with(url:chat_room_chat_messages_path,local:true) do |f| %>
    <%= f.text_field :message, :class => "form-control myform", :placeholder => "メッセージを入力して下さい" %>
    <%= hidden_field_tag :chat_room, params[:id] %>
    <%#= f.hidden_field :chat_room_id, {value: @chat_room.id} %>
      <div class="text-center">
        <%= f.submit "チャットを送る", :class => "btn btn-primary",method: :post %>
      </div>
    <% end %>
    </div>
</form>
